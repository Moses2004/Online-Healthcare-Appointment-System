@model IEnumerable<Online_Healthcare_Appointment_System.Models.Feedback>

@{
    ViewData["Title"] = "Feedbacks";
    bool isAdmin = User.IsInRole("Admin");
    bool isDoctor = User.IsInRole("Doctor");
    bool isPatient = User.IsInRole("Patient");

    string backController = isAdmin ? "Admin" : (isDoctor ? "DoctorDashboard" : "PatientDashboard");
    string backAction = isAdmin ? "Dashboard" : "Index";
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <a asp-controller="@backController" asp-action="@backAction" class="btn btn-outline-secondary">
        <i class="bi bi-arrow-left-circle"></i> Back to Dashboard
    </a>

    @if (isPatient)
    {
        <a asp-action="Create" class="btn btn-success">
            <i class="bi bi-plus-circle"></i> Add Feedback
        </a>
    }
</div>

<div class="card shadow-sm p-3 rounded-3">
    <h3 class="text-center mb-3"><i class="bi bi-chat-dots text-success"></i> Feedback List</h3>

    <table class="table table-hover align-middle text-center">
        <thead class="table-success">
            <tr>
                <th>Feedback ID</th>
                <th>Patient</th>
                <th>Doctor</th>
                <th>Rating</th>
                <th>Comments</th>
                <th>Date</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td>@item.FeedbackId</td>
                    <td>@item.Patient?.Name</td>
                    <td>@item.Doctor?.Name</td>
                    <td>
                        <span class="badge bg-success">@item.Rating ★</span>
                    </td>
                    <td>@item.Comments</td>
                    <td>@item.DateSubmitted.ToString("dd MMM yyyy")</td>
                    <td>
                        <a asp-action="Details" asp-route-id="@item.FeedbackId" class="btn btn-sm btn-primary me-1">
                            <i class="bi bi-eye"></i> View
                        </a>

                        @if (isPatient)
                        {
                            <a asp-action="Edit" asp-route-id="@item.FeedbackId" class="btn btn-sm btn-warning">
                                <i class="bi bi-pencil-square"></i> Edit
                            </a>
                        }
                    </td>
                </tr>
            }
        </tbody>
    </table>

    @if (!Model.Any())
    {
        <div class="alert alert-warning text-center mt-3">
            No feedback found.
        </div>
    }
</div>
